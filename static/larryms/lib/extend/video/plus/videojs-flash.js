(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t(require("video.js")):typeof define==="function"&&define.amd?define(["video.js"],t):e.videojsFlash=t(e.videojs)})(this,function(e){"use strict";e=e&&e.hasOwnProperty("default")?e["default"]:e;var s="5.4.2";var t="2.1.2";function r(o){o.streamingFormats={"rtmp/mp4":"MP4","rtmp/flv":"FLV"};o.streamFromParts=function(e,t){return e+"&"+t};o.streamToParts=function(e){var t={connection:"",stream:""};if(!e){return t}var r=e.search(/&(?![\w-]+=)/);var n=void 0;if(r!==-1){n=r+1}else{r=n=e.lastIndexOf("/")+1;if(r===0){r=n=e.length}}t.connection=e.substring(0,r);t.stream=e.substring(n,e.length);return t};o.isStreamingType=function(e){return e in o.streamingFormats};o.RTMP_RE=/^rtmp[set]?:\/\//i;o.isStreamingSrc=function(e){return o.RTMP_RE.test(e)};o.rtmpSourceHandler={};o.rtmpSourceHandler.canPlayType=function(e){if(o.isStreamingType(e)){return"maybe"}return""};o.rtmpSourceHandler.canHandleSource=function(e,t){var r=o.rtmpSourceHandler.canPlayType(e.type);if(r){return r}if(o.isStreamingSrc(e.src)){return"maybe"}return""};o.rtmpSourceHandler.handleSource=function(e,t,r){var n=o.streamToParts(e.src);t.setRtmpConnection(n.connection);t.setRtmpStream(n.stream)};o.registerSourceHandler(o.rtmpSourceHandler);return o}var n=typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};var o;if(typeof window!=="undefined"){o=window}else if(typeof n!=="undefined"){o=n}else if(typeof self!=="undefined"){o=self}else{o={}}var i=o;var u=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var c=function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t};var l=function(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e};var a=e.getComponent("Tech");var f=e.dom;var p=e.url;var d=e.createTimeRange;var v=e.mergeOptions;var h=i&&i.navigator||{};var y=function(n){c(a,n);function a(e,t){u(this,a);var r=l(this,n.call(this,e,t));if(e.source){r.ready(function(){this.setSource(e.source)},true)}if(e.startTime){r.ready(function(){this.load();this.play();this.currentTime(e.startTime)},true)}i.videojs=i.videojs||{};i.videojs.Flash=i.videojs.Flash||{};i.videojs.Flash.onReady=a.onReady;i.videojs.Flash.onEvent=a.onEvent;i.videojs.Flash.onError=a.onError;r.on("seeked",function(){this.lastSeekTarget_=undefined});return r}a.prototype.createEl=function e(){var t=this.options_;if(!t.swf){t.swf="https://vjs.zencdn.net/swf/"+s+"/video-js.swf"}var r=t.techId;var n=v({readyFunction:"videojs.Flash.onReady",eventProxyFunction:"videojs.Flash.onEvent",errorEventProxyFunction:"videojs.Flash.onError",autoplay:t.autoplay,preload:t.preload,loop:t.loop,muted:t.muted},t.flashVars);var o=v({wmode:"opaque",bgcolor:"#000000"},t.params);var i=v({id:r,name:r,class:"vjs-tech"},t.attributes);this.el_=a.embed(t.swf,n,o,i);this.el_.tech=this;return this.el_};a.prototype.play=function e(){if(this.ended()){this.setCurrentTime(0)}this.el_.vjs_play()};a.prototype.pause=function e(){this.el_.vjs_pause()};a.prototype.src=function e(t){if(t===undefined){return this.currentSrc()}return this.setSrc(t)};a.prototype.setSrc=function e(t){var r=this;t=p.getAbsoluteURL(t);this.el_.vjs_src(t);if(this.autoplay()){this.setTimeout(function(){return r.play()},0)}};a.prototype.seeking=function e(){return this.lastSeekTarget_!==undefined};a.prototype.setCurrentTime=function e(t){var r=this.seekable();if(r.length){t=t>r.start(0)?t:r.start(0);t=t<r.end(r.length-1)?t:r.end(r.length-1);this.lastSeekTarget_=t;this.trigger("seeking");this.el_.vjs_setProperty("currentTime",t);n.prototype.setCurrentTime.call(this)}};a.prototype.currentTime=function e(){if(this.seeking()){return this.lastSeekTarget_||0}return this.el_.vjs_getProperty("currentTime")};a.prototype.currentSrc=function e(){if(this.currentSource_){return this.currentSource_.src}return this.el_.vjs_getProperty("currentSrc")};a.prototype.duration=function e(){if(this.readyState()===0){return NaN}var e=this.el_.vjs_getProperty("duration");return e>=0?e:Infinity};a.prototype.load=function e(){this.el_.vjs_load()};a.prototype.poster=function e(){this.el_.vjs_getProperty("poster")};a.prototype.setPoster=function e(){};a.prototype.seekable=function e(){var t=this.duration();if(t===0){return d()}return d(0,t)};a.prototype.buffered=function e(){var t=this.el_.vjs_getProperty("buffered");if(t.length===0){return d()}return d(t[0][0],t[0][1])};a.prototype.supportsFullScreen=function e(){return false};a.prototype.enterFullScreen=function e(){return false};a.prototype.getVideoPlaybackQuality=function e(){var t=this.el_.vjs_getProperty("getVideoPlaybackQuality");if(i.performance&&typeof i.performance.now==="function"){t.creationTime=i.performance.now()}else if(i.performance&&i.performance.timing&&typeof i.performance.timing.navigationStart==="number"){t.creationTime=i.Date.now()-i.performance.timing.navigationStart}return t};return a}(a);var m=["rtmpConnection","rtmpStream","preload","defaultPlaybackRate","playbackRate","autoplay","loop","controls","volume","muted","defaultMuted"];var g=["networkState","readyState","initialTime","startOffsetTime","paused","ended","videoWidth","videoHeight"];var S=y.prototype;function w(t){var e=t.charAt(0).toUpperCase()+t.slice(1);S["set"+e]=function(e){return this.el_.vjs_setProperty(t,e)}}function b(e){S[e]=function(){return this.el_.vjs_getProperty(e)}}for(var _=0;_<m.length;_++){b(m[_]);w(m[_])}for(var j=0;j<g.length;j++){b(g[j])}y.isSupported=function(){if(e.browser.IS_CHROME&&!e.browser.IS_ANDROID||e.browser.IS_SAFARI&&!e.browser.IS_IOS){return true}return y.version()[0]>=10};a.withSourceHandlers(y);y.nativeSourceHandler={};y.nativeSourceHandler.canPlayType=function(e){if(e in y.formats){return"maybe"}return""};y.nativeSourceHandler.canHandleSource=function(e,t){var r=void 0;function n(e){var t=p.getFileExtension(e);if(t){return"video/"+t}return""}if(!e.type){r=n(e.src)}else{r=e.type.replace(/;.*/,"").toLowerCase()}return y.nativeSourceHandler.canPlayType(r)};y.nativeSourceHandler.handleSource=function(e,t,r){t.setSrc(e.src)};y.nativeSourceHandler.dispose=function(){};y.registerSourceHandler(y.nativeSourceHandler);y.formats={"video/flv":"FLV","video/x-flv":"FLV","video/mp4":"MP4","video/m4v":"MP4"};y.onReady=function(e){var t=f.$("#"+e);var r=t&&t.tech;if(r&&r.el()){y.checkReady(r)}};y.checkReady=function(e){if(!e.el()){return}if(e.el().vjs_getProperty){e.triggerReady()}else{this.setTimeout(function(){y.checkReady(e)},50)}};y.onEvent=function(e,t){var r=f.$("#"+e).tech;var n=Array.prototype.slice.call(arguments,2);r.setTimeout(function(){r.trigger(t,n)},1)};y.onError=function(e,t){var r=f.$("#"+e).tech;if(t==="srcnotfound"){return r.error(4)}if(typeof t==="string"){r.error("FLASH: "+t)}else{t.origin="flash";r.error(t)}};y.version=function(){var t="0,0,0";try{t=new i.ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(e){try{if(h.mimeTypes["application/x-shockwave-flash"].enabledPlugin){t=(h.plugins["Shockwave Flash 2.0"]||h.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}}catch(e){}}return t.split(",")};y.embed=function(e,t,r,n){var o=y.getEmbedCode(e,t,r,n);var i=f.createEl("div",{innerHTML:o}).childNodes[0];return i};y.getEmbedCode=function(e,t,r,n){var o='<object type="application/x-shockwave-flash" ';var i="";var a="";var s="";if(t){Object.getOwnPropertyNames(t).forEach(function(e){i+=e+"="+t[e]+"&amp;"})}r=v({movie:e,flashvars:i,allowScriptAccess:"always",allowNetworking:"all"},r);Object.getOwnPropertyNames(r).forEach(function(e){a+='<param name="'+e+'" value="'+r[e]+'" />'});n=v({data:e,width:"100%",height:"100%"},n);Object.getOwnPropertyNames(n).forEach(function(e){s+=e+'="'+n[e]+'" '});return""+o+s+">"+a+"</object>"};r(y);if(a.getTech("Flash")){e.log.warn("Not using videojs-flash as it appears to already be registered");e.log.warn("videojs-flash should only be used with video.js@6 and above")}else{e.registerTech("Flash",y)}y.VERSION=t;return y});