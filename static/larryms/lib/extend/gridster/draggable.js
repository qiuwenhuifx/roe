(function(t,i){t.delay=function(t,i){var e=Array.prototype.slice.call(arguments,2);return setTimeout(function(){return t.apply(null,e)},i)};t.debounce=function(s,n,o){var r;return function(){var t=this,i=arguments;var e=function(){r=null;if(!o)s.apply(t,i)};if(o&&!r)s.apply(t,i);clearTimeout(r);r=setTimeout(e,n)}};t.throttle=function(i,e){var s,n,o,r,a,h;var l=debounce(function(){a=r=false},e);return function(){s=this;n=arguments;var t=function(){o=null;if(a)i.apply(s,n);l()};if(!o)o=setTimeout(t,e);if(r){a=true}else{h=i.apply(s,n)}l();r=true;return h}}})(window);(function(t,e){if(window.layui&&layui.define){layui.define(["jquery"],function(t){var i=layui.$;t("draggable",e(i))})}else if(typeof define==="function"&&define.amd){define("gridster-draggable",["jquery"],e)}else{t.GridsterDraggable=e(t.$||t.jQuery)}})(this,function(v){var e={items:"li",distance:1,limit:true,offset_left:0,autoscroll:true,ignore_dragging:["INPUT","TEXTAREA","SELECT","BUTTON"],handle:null,container_width:0,move_element:true,helper:false,remove_helper:true};var m=v(window);var w={x:"left",y:"top"};var s=!!("ontouchstart"in window);var y=function(t){return t.charAt(0).toUpperCase()+t.slice(1)};var t=0;var n=function(){return++t+""};function i(t,i){this.options=v.extend({},e,i);this.$document=v(document);this.$container=v(t);this.$dragitems=v(this.options.items,this.$container);this.is_dragging=false;this.player_min_left=0+this.options.offset_left;this.id=n();this.ns=".gridster-draggable-"+this.id;this.init()}i.defaults=e;var o=i.prototype;o.init=function(){var t=this.$container.css("position");this.calculate_dimensions();this.$container.css("position",t==="static"?"relative":t);this.disabled=false;this.events();v(window).bind(this.nsEvent("resize"),throttle(v.proxy(this.calculate_dimensions,this),200))};o.nsEvent=function(t){return(t||"")+this.ns};o.events=function(){this.pointer_events={start:this.nsEvent("touchstart")+" "+this.nsEvent("mousedown"),move:this.nsEvent("touchmove")+" "+this.nsEvent("mousemove"),end:this.nsEvent("touchend")+" "+this.nsEvent("mouseup")};this.$container.on(this.nsEvent("selectstart"),v.proxy(this.on_select_start,this));this.$container.on(this.pointer_events.start,this.options.items,v.proxy(this.drag_handler,this));this.$document.on(this.pointer_events.end,v.proxy(function(t){this.is_dragging=false;if(this.disabled){return}this.$document.off(this.pointer_events.move);if(this.drag_start){this.on_dragstop(t)}},this))};o.get_actual_pos=function(t){var i=t.position();return i};o.get_mouse_pos=function(t){if(t.originalEvent&&t.originalEvent.touches){var i=t.originalEvent;t=i.touches.length?i.touches[0]:i.changedTouches[0]}return{left:t.clientX,top:t.clientY}};o.get_offset=function(t){t.preventDefault();var i=this.get_mouse_pos(t);var e=Math.round(i.left-this.mouse_init_pos.left);var s=Math.round(i.top-this.mouse_init_pos.top);var n=Math.round(this.el_init_offset.left+e-this.baseX+v(window).scrollLeft()-this.win_offset_x);var o=Math.round(this.el_init_offset.top+s-this.baseY+v(window).scrollTop()-this.win_offset_y);if(this.options.limit){if(n>this.player_max_left){n=this.player_max_left}else if(n<this.player_min_left){n=this.player_min_left}}return{position:{left:n,top:o},pointer:{left:i.left,top:i.top,diff_left:e+(v(window).scrollLeft()-this.win_offset_x),diff_top:s+(v(window).scrollTop()-this.win_offset_y)}}};o.get_drag_data=function(t){var i=this.get_offset(t);i.$player=this.$player;i.$helper=this.helper?this.$helper:this.$player;return i};o.set_limits=function(t){t||(t=this.$container.width());this.player_max_left=t-this.player_width+-this.options.offset_left;this.options.container_width=t;return this};o.scroll_in=function(t,i){var e=w[t];var s=50;var n=30;var o=t==="x";var r=o?this.window_width:this.window_height;var a=o?v(document).width():v(document).height();var h=o?this.$player.width():this.$player.height();var l;var f=m["scroll"+y(e)]();var u=f;var p=u+r;var _=p-s;var d=u+s;var c=u+i.pointer[e];var g=a-r+h;if(c>=_){l=f+n;if(l<g){m["scroll"+y(e)](l);this["scroll_offset_"+t]+=n}}if(c<=d){l=f-n;if(l>0){m["scroll"+y(e)](l);this["scroll_offset_"+t]-=n}}return this};o.manage_scroll=function(t){this.scroll_in("x",t);this.scroll_in("y",t)};o.calculate_dimensions=function(t){this.window_height=m.height();this.window_width=m.width()};o.drag_handler=function(t){var i=t.target.nodeName;if(this.disabled||t.which!==1&&!s){return}if(this.ignore_drag(t)){return}var n=this;var o=true;this.$player=v(t.currentTarget);this.el_init_pos=this.get_actual_pos(this.$player);this.mouse_init_pos=this.get_mouse_pos(t);this.offsetY=this.mouse_init_pos.top-this.el_init_pos.top;this.$document.on(this.pointer_events.move,function(t){var i=n.get_mouse_pos(t);var e=Math.abs(i.left-n.mouse_init_pos.left);var s=Math.abs(i.top-n.mouse_init_pos.top);if(!(e>n.options.distance||s>n.options.distance)){return false}if(o){o=false;n.on_dragstart.call(n,t);return false}if(n.is_dragging===true){n.on_dragmove.call(n,t)}return false});if(!s){return false}};o.on_dragstart=function(t){t.preventDefault();if(this.is_dragging){return this}this.drag_start=this.is_dragging=true;var i=this.$container.offset();this.baseX=Math.round(i.left);this.baseY=Math.round(i.top);this.initial_container_width=this.options.container_width||this.$container.width();if(this.options.helper==="clone"){this.$helper=this.$player.clone().appendTo(this.$container).addClass("helper");this.helper=true}else{this.helper=false}this.win_offset_y=v(window).scrollTop();this.win_offset_x=v(window).scrollLeft();this.scroll_offset_y=0;this.scroll_offset_x=0;this.el_init_offset=this.$player.offset();this.player_width=this.$player.width();this.player_height=this.$player.height();this.set_limits(this.options.container_width);if(this.options.start){this.options.start.call(this.$player,t,this.get_drag_data(t))}return false};o.on_dragmove=function(t){var i=this.get_drag_data(t);this.options.autoscroll&&this.manage_scroll(i);if(this.options.move_element){(this.helper?this.$helper:this.$player).css({position:"absolute",left:i.position.left,top:i.position.top})}var e=this.last_position||i.position;i.prev_position=e;if(this.options.drag){this.options.drag.call(this.$player,t,i)}this.last_position=i.position;return false};o.on_dragstop=function(t){var i=this.get_drag_data(t);this.drag_start=false;if(this.options.stop){this.options.stop.call(this.$player,t,i)}if(this.helper&&this.options.remove_helper){this.$helper.remove()}return false};o.on_select_start=function(t){if(this.disabled){return}if(this.ignore_drag(t)){return}return false};o.enable=function(){this.disabled=false};o.disable=function(){this.disabled=true};o.destroy=function(){this.disable();this.$container.off(this.ns);this.$document.off(this.ns);v(window).off(this.ns);v.removeData(this.$container,"drag")};o.ignore_drag=function(t){if(this.options.handle){return!v(t.target).is(this.options.handle)}if(v.isFunction(this.options.ignore_dragging)){return this.options.ignore_dragging(t)}return v(t.target).is(this.options.ignore_dragging.join(", "))};v.fn.drag=function(t){return new i(this,t)};return i});